<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy New Year</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital@1&family=Poppins:wght@400;500&display=swap" rel="stylesheet">

<style>
/* ================= BASE ================= */
body {
  margin: 0;
  background: #050008;
  color: #ffffff;
  font-family: Poppins, sans-serif;
  overflow: hidden; /* KEEP AS ORIGINAL */
}

.page {
  position: absolute;
  inset: 0;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  text-align: center;
}

.page.active {
  display: flex;
}

img {
  max-width: 100%;
  height: auto;
}

/* ================= SPARKLES ================= */
.sparkle {
  position: fixed;
  width: 2px;
  height: 2px;
  background: #fff;
  border-radius: 50%;
  opacity: 0.6;
  animation: twinkle 3s infinite ease-in-out;
}
@keyframes twinkle {
  0%,100% { opacity: 0.2 }
  50% { opacity: 1 }
}

/* ================= TEXT ================= */
h2 {
  font-family: "Playfair Display", serif;
  font-style: italic;
  font-size: 32px;
  color: #f5f0ff;
}
p { font-size: 17px; }

/* ================= PAGE 1 ================= */
.hold-wrapper {
  position: relative;
  width: 150px;
  height: 150px;
  margin-top: 24px;
}

.heart {
  position: absolute;
  inset: 0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:82px;
  cursor:pointer;
}

svg circle { fill:none; stroke-width:6 }
.ring-bg { stroke:#333 }
.ring-progress {
  stroke:#b38cff;
  stroke-dasharray:314;
  stroke-dashoffset:314;
  transform:rotate(-90deg);
  transform-origin:50% 50%;
  transition:stroke-dashoffset 1s linear;
}

/* ================= PAGE 2 ================= */
#p2 {
  justify-content: flex-start;
  padding-top: 32px;
}

.boxes {
  width: 100%;
  max-width: 440px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin: 28px 0;
}

/* âœ… SAFE SCROLL â€” ONLY BOXES */
#p2 .boxes {
  max-height: calc(100vh - 260px);
  overflow-y: auto;
  padding-bottom: 16px;
}

.box {
  height: 56px;
  border-radius: 999px;
  background:
    radial-gradient(
      120% 120% at 50% 0%,
      rgba(180,140,255,0.12),
      rgba(10,5,20,0.65)
    );
  border: 1px solid rgba(180,140,255,0.15);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}

.center-heart {
  color: rgba(255,170,210,0.85);
}

.box span {
  position:absolute;
  opacity:0;
  transition:0.4s ease;
}

.box.revealed .center-heart { opacity:0 }
.box.revealed span { opacity:1 }

/* ================= PAGE 3 ================= */
.hero-img {
  width: 95%;
  max-width: 460px;
  border-radius: 22px;
  margin-bottom: 20px;
}

.envelope {
  font-size: 70px;
  margin-top: 20px;
  cursor: pointer;
}

/* ================= PAGE 4 ================= */
.message-wrapper {
  position: relative;
  width: 100%;
  display: flex;
  justify-content: center;
}

.message-box {
  width: 95%;
  max-width: 520px;
  background: linear-gradient(180deg,#fff,#faf7ff);
  color: #1a1025;
  padding: 32px;
  border-radius: 26px;
  max-height: 70vh;
  overflow-y: auto;
  line-height: 1.7;
}

.l1, .l2 {
  position: absolute;
  width: 70px;
  pointer-events: none;
}

.l1 { top: -18px; left: 6px; }
.l2 { bottom: -18px; right: 6px; }

/* ================= PAGE 5 ================= */
#fireworks-canvas {
  position: fixed;
  inset: 0;
  pointer-events: none;
}

.final-gif {
  width: 90%;
  max-width: 420px;
  margin-top: 20px;
}

/* ================= BUTTON ================= */
button {
  margin-top: 28px;
  padding: 16px 36px;
  font-size: 19px;
  border-radius: 40px;
  border:none;
  background:#b38cff;
  color:white;
}
</style>
</head>

<body>

<script>
for(let i=0;i<80;i++){
  const s=document.createElement("div");
  s.className="sparkle";
  s.style.left=Math.random()*100+"vw";
  s.style.top=Math.random()*100+"vh";
  document.body.appendChild(s);
}
</script>

<!-- PAGE 1 -->
<div class="page active" id="p1">
  <h2>A little surprise for you</h2>
  <p>Before this year begins</p>

  <div class="hold-wrapper">
    <svg width="150" height="150">
      <circle class="ring-bg" cx="75" cy="75" r="50"/>
      <circle class="ring-progress" cx="75" cy="75" r="50"/>
    </svg>
    <div class="heart" id="heart">ðŸ’œ</div>
  </div>
</div>

<!-- PAGE 2 -->
<div class="page" id="p2">
  <h2>You, in 2025 âœ¨</h2>
  <p>Tap each one to reveal</p>

  <div class="boxes">
    <div class="box"><div class="center-heart">â™¡</div><span>The more I notice you, the more beautiful you become.</span></div>
    <div class="box"><div class="center-heart">â™¡</div><span>You have the brightest smile Iâ€™ve ever seen.</span></div>
    <div class="box"><div class="center-heart">â™¡</div><span>You are so, so hardworking.</span></div>
    <div class="box"><div class="center-heart">â™¡</div><span>Youâ€™re one of the best people Iâ€™ve come to know.</span></div>
    <div class="box"><div class="center-heart">â™¡</div><span>You lit up my entire year.</span></div>
  </div>

  <button onclick="go(3)">See more â†’</button>
</div>

<!-- PAGE 3 -->
<div class="page" id="p3">
  <img src="card-front.webp" class="hero-img">
  <div class="envelope" onclick="go(4)">ðŸ’Œ</div>
</div>

<!-- PAGE 4 -->
<div class="page" id="p4">
  <h2>For pretty baby lei :)</h2>

  <div class="message-wrapper">
    <img src="lily.webp" class="l1">
    <img src="lily.webp" class="l2">

    <div class="message-box">
      <p>
        Hey Lei,<br><br> I wish you a very happy new year. I want you to know that I'm very proud of you. I hope this year brings you the freedom, peace and happiness you have always longed for. Wherever life may take you, I hope you always keep smiling and know that you're deeply cherished and cared for so you never doubt yourself. I'll always pray and wish for your success and well being. Always remember you're very special so don't let others take away what's given to you by God Himself. And I hope our paths may cross again someday, maybe over that coffee we talked about. <br><br> always wishing you well, <br><br> Raab<3
 </p>
    </div>
  </div>

  <button onclick="handleFireworks()">Watch fireworks</button>
</div>

<!-- PAGE 5 -->
<div class="page" id="p5">
  <canvas id="fireworks-canvas"></canvas>
  <h2>I hope this year is kinder to you,<br>and reminds you how deeply loved you are.</h2>
  <img src="final.gif" class="final-gif">
</div>

<script src="index.umd.js"></script>

<script>
let holdTimer;
const ring=document.querySelector(".ring-progress");
const heart=document.getElementById("heart");

heart.onmousedown=heart.ontouchstart=()=>{
  ring.style.strokeDashoffset=0;
  holdTimer=setTimeout(()=>go(2),1000);
};
heart.onmouseup=heart.ontouchend=()=>{
  ring.style.strokeDashoffset=314;
  clearTimeout(holdTimer);
};

function go(n){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById("p"+n).classList.add("active");
}

document.querySelectorAll(".box").forEach(b=>{
  b.onclick=()=>b.classList.add("revealed");
});

/* FIREWORKS + SOUND */
let fireworksInstance=null;
let soundInterval=null;

function handleFireworks(){
  go(5);
  startFireworks();
  startSound();
}

function startFireworks(){
  if(fireworksInstance) return;
  fireworksInstance=new Fireworks.default(
    document.getElementById("fireworks-canvas"),
    {
      intensity:22,
      delay:{min:55,max:95},
      particles:95,
      gravity:1.25,
      hue:{min:255,max:285},
      sound:{enabled:false}
    }
  );
  fireworksInstance.start();
}

function startSound(){
  if(soundInterval) return;
  const sounds=[new Audio("explosion0.mp3"),new Audio("explosion1.mp3")];
  sounds.forEach(s=>s.volume=0.25);
  soundInterval=setInterval(()=>{
    const s=sounds[Math.floor(Math.random()*sounds.length)];
    s.currentTime=0;
    s.play();
  },3500);
}
</script>

</body>
</html>
